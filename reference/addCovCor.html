<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Add correlation of anchor signals to pairs of close genomic regions. — addCovCor • sevenC</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Add correlation of anchor signals to pairs of close genomic regions. — addCovCor" />

<meta property="og:description" content="This function adds a vector with correlation values for each input
interaction. Only works for input interaction within the given maxDist
distance. Note, this function does not work on windows because reading of
bigWig files is currently not supported on windows." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sevenC</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/sevenC.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ibn-salem/sevenC">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add correlation of anchor signals to pairs of close genomic regions.</h1>
    <small class="dont-index">Source: <a href='https://github.com/ibn-salem/sevenC/blob/master/R/interaction.R'><code>R/interaction.R</code></a></small>
    <div class="hidden name"><code>addCovCor.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function adds a vector with correlation values for each input
interaction. Only works for input interaction within the given <code>maxDist</code>
distance. Note, this function does not work on windows because reading of
bigWig files is currently not supported on windows.</p>
    
    </div>

    <pre class="usage"><span class='fu'>addCovCor</span>(<span class='no'>gi</span>, <span class='kw'>datacol</span> <span class='kw'>=</span> <span class='st'>"chip"</span>, <span class='kw'>colname</span> <span class='kw'>=</span> <span class='st'>"cor_chip"</span>, <span class='kw'>maxDist</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>use</span> <span class='kw'>=</span> <span class='st'>"everything"</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='st'>"pearson"</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>gi</th>
      <td><p>A sorted <code><a href='http://www.rdocumentation.org/packages/InteractionSet/topics/GInteractions-class'>GInteractions</a></code> object.</p></td>
    </tr>
    <tr>
      <th>datacol</th>
      <td><p>a string matching an annotation column in <code>regions(gi)</code>.
This column is assumed to hold the same number of values for each
interaction as a <code>NumericList</code>.</p></td>
    </tr>
    <tr>
      <th>colname</th>
      <td><p>A string that is used as columnname for the new column in
<code>gi</code>.</p></td>
    </tr>
    <tr>
      <th>maxDist</th>
      <td><p>maximal distance of pairs in bp as numeric. If maxDist=NULL,
the maximal distance is computed from input interactions gi by
<code>max(pairdist(gi))</code>.</p></td>
    </tr>
    <tr>
      <th>use</th>
      <td><p>an optional character string giving a method for computing
covariances in the presence of missing values. See <code><a href='http://www.rdocumentation.org/packages/stats/topics/cor'>cor</a></code>
for more details.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>a character string indicating which correlation coefficient (or
covariance) is to be computed. One of "pearson" (default), "kendall", or
"spearman": can be abbreviated. See <code><a href='http://www.rdocumentation.org/packages/stats/topics/cor'>cor</a></code> for more
details.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='http://www.rdocumentation.org/packages/InteractionSet/topics/GInteractions-class'>GInteractions</a></code> similar to <code>gi</code>
 just with an additional column added.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='no'>.Platform</span>$<span class='no'>OS.type</span> <span class='kw'>!=</span> <span class='st'>"windows"</span>) {

  <span class='co'># use internal motif data on chromosome 22</span>
  <span class='no'>motifGR</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>sevenC</span><span class='kw ns'>::</span><span class='no'><a href='http://www.rdocumentation.org/packages/sevenC/topics/motif.hg19.CTCF.chr22'>motif.hg19.CTCF.chr22</a></span>

  <span class='co'># use example bigWig file</span>
 <span class='no'>exampleBigWig</span> <span class='kw'>&lt;-</span> <span class='fu'>system.file</span>(<span class='st'>"extdata"</span>,
     <span class='st'>"GM12878_Stat1.chr22_1-30000000.bigWig"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"sevenC"</span>)

  <span class='co'># add coverage from bigWig file</span>
  <span class='no'>motifGR</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='addCovToGR.html'>addCovToGR</a></span>(<span class='no'>motifGR</span>, <span class='no'>exampleBigWig</span>)

  <span class='co'># get all pairs within 1Mb</span>
  <span class='no'>gi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='getCisPairs.html'>getCisPairs</a></span>(<span class='no'>motifGR</span>, <span class='fl'>1e5</span>)

  <span class='co'># compute correaltion of coverge for each pair</span>
  <span class='no'>gi</span> <span class='kw'>&lt;-</span> <span class='fu'>addCovCor</span>(<span class='no'>gi</span>)

  <span class='co'># addCovCor adds a new metadata column:</span>
  <span class='fu'>mcols</span>(<span class='no'>gi</span>)

}</div><div class='output co'>#&gt; DataFrame with 2808 rows and 2 columns
#&gt;           dist           cor_chip
#&gt;      &lt;integer&gt;          &lt;numeric&gt;
#&gt; 1        19119  0.339540495724593
#&gt; 2        52360 -0.104691613939358
#&gt; 3        53000  0.885072700379391
#&gt; 4        53639 -0.170960689666582
#&gt; 5        61058 -0.104691613939358
#&gt; ...        ...                ...
#&gt; 2804     49248                 NA
#&gt; 2805     61304                 NA
#&gt; 2806     29898                 NA
#&gt; 2807     41954                 NA
#&gt; 2808     12056                 NA</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Jonas Ibn-Salem.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

